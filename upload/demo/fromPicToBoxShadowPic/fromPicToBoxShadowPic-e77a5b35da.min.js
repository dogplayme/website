function FromPicToBoxShadowPic(){this.manager={before:{width:0,height:0},after:{sideLength:0,width:0,height:0,imageData:[],boxShadowString:""},outsideChain:"../../",path:"lib/pic/demo/fromPicToBoxShadowPic/"},"function"!=typeof this.getBeforeData&&(FromPicToBoxShadowPic.prototype.getBeforeData=function(e){this.manager.before.width=e.width,this.manager.before.height=e.height}),"function"!=typeof this.getUserSettingData&&(FromPicToBoxShadowPic.prototype.getUserSettingData=function(e,t,a){this.manager.after.sideLength=e,this.manager.after.width=t,this.manager.after.height=a}),"function"!=typeof this.calAfterImageData&&(FromPicToBoxShadowPic.prototype.calAfterImageData=function(e){var t=document.createElement("canvas");t.width=this.manager.after.width,t.height=this.manager.after.height;var a=t.getContext("2d"),n=this.manager.before.width,i=this.manager.before.height,o=this.manager.after.width,r=this.manager.after.height;a.drawImage(e,0,0,n,i,0,0,o,r),this.manager.after.imageData=a.getImageData(0,0,o,r),t=a=n=i=o=r=null}),"function"!=typeof this.calBoxShadowString&&(FromPicToBoxShadowPic.prototype.calBoxShadowString=function(){for(var e="",t=this.manager.after.imageData.data,a=0,n=t.length;a<n;a+=4){var i=Math.floor(a/4/this.manager.after.width),o=a/4%this.manager.after.width+1,r="rgba("+t[a]+", "+t[a+1]+", "+t[a+2]+", "+t[a+3]+")";e+=" "+o+"em "+i+"em "+r+","}this.manager.after.boxShadowString=e.substr(1,e.length-2),t=e=null}),"function"!=typeof this.paint&&(FromPicToBoxShadowPic.prototype.paint=function(e){e.parentNode.style.fontSize=this.manager.after.sideLength+"px",e.style.boxShadow=this.manager.after.boxShadowString}),"function"!=typeof this.setParentSize&&(FromPicToBoxShadowPic.prototype.setParentSize=function(e){e.parentNode.style.width=this.manager.after.width*this.manager.after.sideLength+"px",e.parentNode.style.height=this.manager.after.height*this.manager.after.sideLength+"px"}),"function"!=typeof this.getScaleValue&&(FromPicToBoxShadowPic.prototype.getScaleValue=function(e,t){var a=this.manager.before.width/this.manager.before.height;return"width"==e?t/a:t*a})}var EventUtil={addHandler:function(e,t,a){e.addEventListener?e.addEventListener(t,a,!1):e.attachEvent?e.attachEvent("on"+t,a):e["on"+t]=a}};window.onload=function(){var e=new FromPicToBoxShadowPic,t=document.getElementById("before"),a=document.getElementById("beforeWidth"),n=document.getElementById("beforeHeight"),i=document.getElementById("after"),o=document.getElementById("afterWidth"),r=document.getElementById("afterHeight"),h=document.getElementById("selectPic"),d=document.getElementById("submit"),g=document.getElementsByClassName("settingIco")[0],c=document.getElementsByClassName("setting")[0];e.getBeforeData(t),a.innerText=e.manager.before.width,n.innerText=e.manager.before.height,afterHeight.value=parseInt(e.getScaleValue("width",o.value)),EventUtil.addHandler(h,"change",function(){var i=h.value;t.src=i,t.onload=function(){document.getElementById("displayImage").src=i,e.getBeforeData(t),a.innerText=e.manager.before.width,n.innerText=e.manager.before.height,afterHeight.value=parseInt(e.getScaleValue("width",o.value))}}),EventUtil.addHandler(d,"click",function(){c.style.display="none",e.getUserSettingData(document.getElementById("afterSideLength").value,o.value,r.value),e.calAfterImageData(t),e.calBoxShadowString(),e.paint(i),e.setParentSize(i)}),EventUtil.addHandler(o,"focusout",function(){1==document.getElementById("scale").checked&&(afterHeight.value=parseInt(e.getScaleValue("width",o.value)))}),EventUtil.addHandler(r,"focusout",function(){1==document.getElementById("scale").checked&&(o.value=parseInt(e.getScaleValue("height",r.value)))}),EventUtil.addHandler(g,"click",function(){c.style.display="block"})};